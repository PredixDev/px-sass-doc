<link rel="import" href="../polymer/polymer-element.html"/>
<link rel="import" href="../polymer/lib/elements/dom-if.html"/>
<link rel="import" href="../px-clipboard/px-clipboard.html"/>
<link rel="import" href="../px-dropdown/px-dropdown.html"/>
<link rel="import" href="../px-icon-set/px-icon-set.html"/>
<link rel="import" href="px-sass-doc-header.html"/>
<link rel="import" href="px-sass-doc-demo.html"/>
<link rel="import" href="px-sass-doc-viewer.html"/>
<link rel="import" href="px-sass-doc-footer.html"/>
<link rel="import" href="css/px-demo-styles.html" />

<!--
Element providing documentation for a requested Predix UI CSS module.

Pass additional content into its light DOM to pass down to its children.

##### Usage

      <px-sass-doc
        module-name="px-buttons-design"
        description="Element providing styles for buttons."
        layer="objects"
        dependencies='[
          "https://github.com/PredixDev/px-colors-design",
          "https://github.com/PredixDev/px-defaults-design",
          "https://github.com/PredixDev/px-helpers-design"
        ]'
        selected-options="{{selectedOptions}}">
      </px-sass-doc>

@element px-sass-doc
@blurb Element providing documentation for a requested Predix UI CSS module.
@homepage index.html
@demo index.html
-->

<dom-module id="px-sass-doc">
  <template>
  <style include="px-demo-styles"></style>

  <!-- Header -->
  <px-sass-doc-header
    module-name="[[moduleName]]"
    module-description="[[description]]">
  </px-sass-doc-header>

  <template is="dom-if" if="[[!hideDemoContainer]]">
    <!-- Demo -->
    <px-sass-doc-demo selected-options="{{selectedOptions}}" selected-tab="{{selectedTab}}" tabs="[[tabs]]">
      <!-- Previously: <content select="px-sass-doc-option" ...> -->
      <slot name="options" slot="options"></slot>
      <!-- Previously: <content select="[data-slot=demoHTML]" ...> -->
      <slot name="demo-html" slot="demo-html"></slot>
      <!-- Previously: <content select="[data-slot=import]" ...> -->
      <slot name="import" slot="import"></slot>
    </px-sass-doc-demo>
  </template>
  <template is="dom-if" if="[[hideDemoContainer]]">
    <hr class="demo-hr u-m0"/>
  </template>

  <!-- Viewer -->
  <px-sass-doc-viewer library-name=[[moduleName]] base-name=[[baseName]] layer=[[layer]] inuit-flags=[[inuitFlags]] dependencies=[[dependencies]] hide-import-sass=[[hideImportSass]] sassdoc-path=[[sassdocPath]]>
    <!-- Previously: <content select="[data-slot=intro]" ...> -->
    <slot name="intro" slot="intro"></slot>
    <!-- Previously: <content select="[data-slot=usage]" ...> -->
    <slot name="usage" slot="usage"></slot>
  </px-sass-doc-viewer>

  <!-- Footer -->
  <px-sass-doc-footer></px-sass-doc-footer>

  </template>
</dom-module>

<script>
  class PxSassDoc extends Polymer.Element {
    static get is() { return 'px-sass-doc'; }

    static get properties() {
      return {
        /**
         * Name of the Sass module.
         */
        moduleName: {
          type: String
        },

        /**
         * Description of the Sass module.
         */
        description: {
          type: String
        },

        /**
         * Sass layer that this component belongs in, e.g. generic, objects,
         * trumps, etc.
         */
        layer: {
          type: String
        },

        /**
         * List of modules this module depends on (as Github repository URLs).
         */
        dependencies: {
          type: Array,
          value: () => []
        },

        /**
         * Path to a generated Sassdoc JSON file.
         */
        sassdocPath: {
          type: String
        },

        /**
         * Inuit flags that are used to enable features and functionality,
         * represented as an array of strings, which will display with line
         * breaks between each.
         */
        inuitFlags: {
          type: Array,
          value: () => []
        },

        /**
         * Base name of the component in the file path, e.g. _objects.BASENAME.scss.
         * Computed from the moduleName.
         */
        baseName: {
          type: String,
          computed: '_computeBaseName(moduleName)'
        },

        /**
         * A list of tabs that will change our demo container.
         */
        tabs: {
          type: Array,
          value: () => []
        },

        /**
         * Set to `true` to hide the demo container (i.e. if you just have
         * simple API docs.)
         */
        hideDemoContainer: {
          type: Boolean,
          value: false
        },

        /**
         * Set to `true` to hide the instructions to "Import in your Sass".
         */
        hideImportSass: {
          type: Boolean,
          value: false
        },

        /**
         * The currently selected options, passed up from px-sass-doc-demo.
         */
        selectedOptions: {
          type: Object,
          notify: true,
          value: () => []
        },

        /**
         * The currently selected tab, passed up from px-sass-doc-demo.
         */
        selectedTab: {
          type: String,
          notify: true,
          value: ''
        }
      };
    }

    _computeBaseName(moduleName) {
      if (!moduleName) return;
      return moduleName.replace('px-','').replace('-design','');

    }
  }

  customElements.define('px-sass-doc', PxSassDoc);
</script>
